language: java
jdk:
  - openjdk14

# создание БД для тестов
services:
  - postgresql
before_install:
  - psql -c "CREATE DATABASE forum;" -U postgres

# используем режим обычного пользователя для сборки проекта.
sudo: false

install: true

script: mvn clean package -DskipTests=true

# после выполнения сборки запустить скрипт, который будет собирать статистику по JaCoCo
# Здесь используется сторонни сервис https://codecov.io/
after_success:
  - bash <(curl -s https://codecov.io/bash)

# Отправлять уведомление на selesitomorozov@gmail.com если сборка упала
notifications:
  email:
    recipients:
      - selesitomorozov@gmail.com
    on_success: never # default: change
    on_failure: always # default: always
env:
  global:
    - CODECOV_TOKEN="3a37acdb-bfcf-404c-b33b-266ca71c3de7"

deploy:
  provider: heroku
  api_key:
    secure: Sb8pjcp6uCzaINzxP7Q1WX7blILXn7C+iPrtBcH8KE860lWvDjdZK8O4BGk0Wg4Sxk8uxjsLkR3vt7PyCQNqia8ZFR/dX4jN83iNEulWu0ipGnhfxJ900XdWmJq9g1wbdnwmjCEI0+EJ2HL69Fq7Iuzf3jCDf4qJbnryDdArIWt342dxp1qX1yoNGVZLFHwXuBc6TyHHvGgHU2lV0pbnQWrCHY5mvx2aiP3chR0XFH5jFrDx7KjUOTBBsLMFsBxVjm1zVIBJ/kGiOjpAN2jJitPHlXuvHDnZVqscDqJGnc+M4zdck8uh/48dbzEklEQiHwLEjLVf6H39dfdtzxfj/ilTn3ZF7MzjLXxGHdyd4eAjdGqbWcUYjVY5ApuF186RKnveJnGbFd9L7dFauRcRUzmkVxA0BA58IGsG83GVraCMvQgPxuFw2Kwz8Fuq1HgN5k6BvAuZSqX0Yqcw/I/YrAMnY2Oi4L70XVkZ4vjw2dV6QSZRfVCSOSKKr/c+kWiXWYnBmHKODbpVhN9M/dHs68HDIgiKVdmk1es8N2JZswaGF+QKr5V7rJtINWmW9jzVKTFEGuFzT62zEZojgEW5Lpus52HIyAQmfRFflChYN49lhx2N+4dJ33YtSpXbeEv+9N3f/TrtGs6A14XKO2tsKIPpvGowSr3PhHxEBbRLal4=
  app: immense-ravine-02598

